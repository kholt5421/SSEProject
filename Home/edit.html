<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="../index.html"></script>
        <script src="../DatabaseFiles/MongoConnections.js"></script>
        <script>
            function edit(){
                //Create new user information
                var newUserInformation = [];
                for(let i = 0; i < 3; i++){
                    //Get data from the form
                    var information = document.getElementById("information");
                    var userData = JSON.parse(sessionStorage.getItem("userData"));
                    if(information.element[i].value == ""){
                        newUserInformation[i] = userData[i];
                    }else{
                        newUserInformation[i] = information.element[i].value;
                    }
                }
                //Create document data
                var data = {
                    $set: {
                        username: newUserInformation[0],
                        email: newUserInformation[1],
                        password: newUserInformation[2]
                    }
                };
                var filter = {
                    user_id: userId
                };
                //Update mongo database
                update(data,filter).then(() => {});
                //Update session storage
                for(let i = 0; i < 3; i++){
                    userData[i] = newUserInformation[i];
                }
                sessionStorage.setItem("userData",JSON.stringify(userData));
                //Return to the profile page
                window.location.href = "profile.html";
            }
        </script>
        <link rel="stylesheet" href="../styles.css">
    </head>
    <body>
        <div class="menu" style="height: 430px">
            <h1>Edit Your Profile</h1>
            <div class="form">
                <form id="newInformation">
                    <p id="username"></p>
                    <p>New Username</p>
                    <input type="text" id="username" name="username">
                    <p id="email"></p>
                    <p>New Email:</p>
                    <input type="text" id="email" name="email">
                    <p id="password"></p>
                    <p>New Password</p>
                    <input type="text" id="password" name="password">
                    <br><br>
                    <input class="submit" type="submit" value="Submit" onclick="edit()">
                </form>
            </div>
        </div>
        <script>
            document.getElementById("username").innerHTML = "Current Username: "+userData[0];
            document.getElementById("email").innerHTML = "Current Email: "+userData[1];
            document.getElementById("password").innerHTML = "Current Password: "+userData[2];
        </script>
    </body>
</html>